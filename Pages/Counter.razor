@page "/counter"
@layout MainLayout

<PageTitle>Playlist Random</PageTitle>
<div class="playlists"> 
<h1>🎵 Playlist del giorno</h1>

<p>Clicca il pulsante per vedere una playlist casuale!</p>

<button class="btn btn-primary" @onclick="ShowRandomPlaylist">Mostra playlist</button>
</div>

@if (!string.IsNullOrEmpty(selectedPlaylistId))
{
    <div class="mt-3">
        <div class="ratio ratio-16x9" style="max-height: 400px;">
            <iframe 
                data-testid="embed-iframe" 
                style="border-radius:12px" 
                src="https://open.spotify.com/embed/playlist/@selectedPlaylistId?utm_source=generator" 
                frameBorder="0" 
                allowfullscreen="" 
                allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
                loading="lazy">
            </iframe>
        </div>
        <div class="mt-2">
            <a href="https://open.spotify.com/playlist/@selectedPlaylistId" 
               target="_blank" 
               class="btn btn-success">
                🎧 Ascolta su Spotify
            </a>
        </div>
    </div>
    
}

@code {
    private PlaylistInfo[] playlists = new[]
    {
        new PlaylistInfo("37i9dQZF1DX0XUsuxWHRQd", "RapCaviar"),
        new PlaylistInfo("37i9dQZF1DWXU2naFUn37x", "Global Top 50"),
        new PlaylistInfo("37i9dQZF1DWSxF6XNtQ9Rg", "Hot Country"),
        new PlaylistInfo("37i9dQZF1DX76Wlfdnj7AP", "Beast Mode"),
        new PlaylistInfo("37i9dQZF1DWXRqgorJj26U", "Rock Classics")
    };

    private string? selectedPlaylistId;

    private void ShowRandomPlaylist()
    {
        var random = new Random();
        var playlist = playlists[random.Next(playlists.Length)];
        selectedPlaylistId = playlist.Id;
    }

    private record PlaylistInfo(string Id, string Name);
}
